<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Selecciona tu estilo actual - Auréthica</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Use the same CSS as gallery for consistency */
    .current-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    .styles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }
    .style-card {
      border: 1px solid #eee;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .style-card.selected {
      box-shadow: 0 0 0 3px #b4a26e;
      transform: translateY(-5px);
    }
    .style-card img {
      width: 100%;
      display: block;
      height: 200px;
      object-fit: cover;
    }
    .style-card .info {
      padding: 10px;
    }
    .style-card .info h3 {
      margin: 0 0 5px 0;
      font-size: 1.2em;
    }
    .style-card .info p {
      margin: 0;
      font-size: 0.9em;
      color: #555;
    }
    .selection-info {
      margin: 20px 0;
      font-size: 1.1em;
      font-weight: bold;
    }
    .action-buttons {
      margin-top: 20px;
      text-align: center;
    }
    .action-buttons button {
      padding: 10px 20px;
      font-size: 1em;
      border: none;
      border-radius: 6px;
      background-color: #a48a5e;
      color: #fff;
      cursor: pointer;
    }
    .action-buttons button:disabled {
      background-color: #ccc;
      cursor: default;
    }
  </style>
</head>
<body>
  <div class="current-container">
    <h1>Selecciona tu estilo actual</h1>
    <p>Elige 1 o 2 estilos con los que te identificas hoy.</p>
    <div class="selection-info" id="selectionInfo">0 de 2 seleccionados</div>
    <div class="styles-grid" id="stylesGrid"></div>
    <div class="action-buttons">
      <button id="continueBtn" disabled>Ver resultado</button>
    </div>
  </div>
  <script>
    const selectionLimit = 2;
    const selectedStyles = new Set();
    const stylesGrid = document.getElementById('stylesGrid');
    const selectionInfo = document.getElementById('selectionInfo');
    const continueBtn = document.getElementById('continueBtn');
    function updateSelectionInfo() {
      selectionInfo.textContent = selectedStyles.size + ' de ' + selectionLimit + ' seleccionados';
      continueBtn.disabled = selectedStyles.size === 0;
    }
    function toggleCard(card, id) {
      if (selectedStyles.has(id)) {
        selectedStyles.delete(id);
        card.classList.remove('selected');
      } else {
        if (selectedStyles.size >= selectionLimit) return;
        selectedStyles.add(id);
        card.classList.add('selected');
      }
      updateSelectionInfo();
    }
    // Load styles from API
    function loadStyles() {
      const stylesGrid = document.getElementById('stylesGrid');
      
      if (window.AurethicaUI && window.AurethicaAPI) {
        window.AurethicaUI.withLoadingAndError(
          stylesGrid,
          () => window.AurethicaAPI.getStyles(),
          (data) => {
            data.forEach(style => {
              const card = document.createElement('div');
              card.className = 'style-card';
              card.innerHTML = '<img src="' + style.images[0] + '" alt="' + style.name + '"><div class="info"><h3>' + style.name + '</h3><p>' + style.short + '</p></div>';
              card.addEventListener('click', () => toggleCard(card, style.id));
              stylesGrid.appendChild(card);
            });
          },
          'Error al cargar los estilos. Por favor, recarga la página.'
        );
      } else {
        // Fallback to original fetch if API helpers not available
        fetch('data/styles.json')
          .then(res => res.json())
          .then(data => {
            data.forEach(style => {
              const card = document.createElement('div');
              card.className = 'style-card';
              card.innerHTML = '<img src="' + style.images[0] + '" alt="' + style.name + '"><div class="info"><h3>' + style.name + '</h3><p>' + style.short + '</p></div>';
              card.addEventListener('click', () => toggleCard(card, style.id));
              stylesGrid.appendChild(card);
            });
          })
          .catch(err => {
            stylesGrid.innerHTML = '<p>Error loading styles.</p>';
          });
      }
    }

    // Load styles on page load
    loadStyles();
    continueBtn.addEventListener('click', () => {
      const currentSelection = Array.from(selectedStyles);
      localStorage.setItem('current', JSON.stringify(currentSelection));
      window.location.href = 'result.html';
    });
    updateSelectionInfo();
  </script>
  
  <!-- Auréthica API Integration -->
  <script src="assets/js/api.js"></script>
  <script src="assets/js/ui-helpers.js"></script>
  <script>
    // API connectivity verification
    if (window.AurethicaAPI) {
      window.AurethicaAPI.checkHealth()
        .then(health => console.log('API Health:', health))
        .catch(err => console.warn('API not available:', err));
    }
  </script>
</body>
</html>
